<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>记录</title>
    <style>
        *{
            padding: 0px;
            margin: 0px;
        }
        body{
            text-align: center;
        }
        .banner{
            height: 30px;
            width: 900px;
            background: black;
            text-align: center;
            display: inline-block;
        }
        .banner_text{
            color: gray;
            line-height: 30px;
            vertical-align: middle;
            font-family: "arial";
            cursor: pointer;
        }
        .banner_text:hover{
            color: white;
        }
        .message_list{
            display: block;
            width: 900px;
            background: darkblue;
            margin: 0 auto;
            list-style: none;
        }
        .list{
            width: 100%;
            height: 70px;
            background: #faffb3;
            position: relative;
            overflow: hidden;
            border-top: 1px solid black;
        }
        .msg{
            position: absolute;
            left: 10px;
            top: 5px;
            word-break: break-word;
        }
        .toggle{
            position: absolute;
            right: 10px;
            top: 60%;
            cursor: pointer;

            overflow: hidden;
        }
        .time{
            position: absolute;
            left: 10px;
            top: 75%;
            font-size: 10px;
            color: gray;
        }
        .dis_div{
            width: 100%;
            height: 100%;
            display: none;
            background: #a29c9b;
            position: absolute;
            line-height: 30px;
            vertical-align: middle;
            color: white;
            cursor: pointer;
        }
        .dis_div:hover{
            background: #d9ffee;
            color: black;
        }
    </style>
    <script>
    window.onload=function () {
        class MyQuery{
            constructor(){
                this.id=undefined;
            }
            //通过ID获取元素
            GetId(id){
                this.id=id;
                this.el=document.getElementById(this.id);
                return this;
            }
            //设置元素文本
            SetText(text){
                this.text=text;
                this.el.innerText=this.text;
            }
            //点击事件
            OnClick(fn){
                this.click=fn;
                if(this.el===null||this.el===undefined){
                    console.log("未选择元素");
                }else{
                    this.el.onclick=this.click;
                }
            }
            //通过Class获取元素
            ClassQ(cs,index){
                let cas;
                this.cs=cs;
                cas=document.getElementsByClassName(this.cs);
                this.el=cas[index];
                return this;
            }
            //渐入动画（有BUG）
            FadeIn(time, speed){
                let id=this.el;
                let op;
                let dis;
                if(speed===null||undefined){
                    speed=0.1;
                }
                let timer=setInterval(function () {
                    op=parseInt(getComputedStyle(id).opacity);
                    dis=getComputedStyle(id).display;
                    // console.log(op);
                    if(dis==="none"){
                        id.style.display="block";
                    }
                    if(op===0){
                        op=1;
                    }
                    id.style.opacity=op+speed;
                    if(op+speed>=1){
                        clearInterval(timer);
                    }
                },time);
            }
            //渐出动画
            FadeOut(time, speed){
                let id=this.el;
                let op;
                let dis;
                if(speed===null||undefined){
                    speed=0.1;
                }
                let timer=setInterval(function () {
                    op=parseInt(getComputedStyle(id).opacity);
                    dis=getComputedStyle(id).display;
                    if(dis==="none"){
                        id.style.display="block";
                        id.style.opacity="0";
                    }
                    id.style.opacity=op-speed;
                    if(op+speed<=0){
                        clearInterval(timer);
                    }
                },time);
            }
            //上升动画
            Up(time, speed){
                this.time=time;
                let id=this.el;
                let faterHeight;
                let fater;
                if(speed===null||undefined){
                    speed=10;
                }
                if(!isNaN(this.time)){
                    let timer=setInterval(function () {
                        id.style.display="none";
                        fater=id.parentNode;
                        faterHeight=parseInt(getComputedStyle(fater).height);
                        fater.style.height=faterHeight-speed+"px";
                        if(faterHeight-speed<=30){
                            clearInterval(timer);
                        }
                    },this.time);
                }else{
                    console.log("不是数字");
                }
            }
            //设置元素背景
            SetBackG(info){
                let img=info.MyUrl;
                let BgStyle=info.MyStyle;
                let id=this.el;
                id[0].style.background=img+"no-repeat 0 0";
                id[0].style.backgroundSize=BgStyle;
            }
            //通过tag获取元素
            GetTag(name){
                this.el=document.getElementsByTagName(name);
                return this;
            }
            //下滑动画
            Down(time, speed){
                this.time=time;
                let id=this.el;
                let faterHeight;
                let fater;
                if(speed===null||undefined){
                    speed=10;
                }
                if(!isNaN(this.time)){
                    let timer=setInterval(function () {
                        id.style.opacity="0";
                        id.style.display="none";
                        fater=id.parentNode;
                        faterHeight=parseInt(getComputedStyle(fater).height);
                        fater.style.height=faterHeight+speed+"px";
                        if(faterHeight+speed>=70){
                            clearInterval(timer);
                        }
                    },this.time);
                }else{
                    console.log("不是数字");
                }
            }
        }


        let $=new MyQuery();//实例化
        let BgSz=["./bg1.jpg","./bg2.jpg","./bg3.jpg","https://keepcodeing.github.io/InfectedZer-S/Img/bg4.jpg"];//存背景
        //隐藏动画
        function toggleC(i){
            $.ClassQ("toggle",i).OnClick(function () {
                $.ClassQ("toggle",i).Up(15,1);
                $.ClassQ("dis_div",i).FadeIn(500,0.01);

            });
        }
        //显示动画
        function dis_divC(i){
            $.ClassQ("dis_div",i).OnClick(function () {
                $.ClassQ("dis_div",i).Down(15,1);
                $.ClassQ("toggle",i).FadeIn(500,0.11);
            });
        }
        //动态添加li和里面的内容
        function appen(info) {
            let box=$.ClassQ("message_list",0);
            let  child=document.createElement("li");
            let childspan1=document.createElement("span");
            let childspan2=document.createElement("span");
            let childspan3=document.createElement("span");
            let childspan4=document.createElement("span");
            let childdiv=document.createElement("div");
            box=box["el"];
            child.setAttribute("class","list");
            child.appendChild(childspan1).setAttribute("class","msg");
            child.appendChild(childspan2).setAttribute("class","toggle");
            child.appendChild(childspan3).setAttribute("class","time");
            child.appendChild(childdiv).setAttribute("class","dis_div");
            childdiv.appendChild(childspan4);
            childspan1.innerText=info.MyMsg;
            childspan2.innerText="Hide";
            childspan3.innerText=info.time;
            childspan4.innerText="一条被折叠，点击展开";
            box.appendChild(child);
        }
        appen({
            MyMsg:"2018年10月20日写出记录版页面",
            time:"2018.10.20 18:02 武汉"
        });
        appen({
            MyMsg:"没什么好些的，看看就行。原生JS任然不是很熟练...",
            time:"2018.10.20 18:07 武汉"
        });
        appen({
           MyMsg:"十月十九日U盘被摔成磁盘，所幸大部分数据已被恢复。毫无笋丝....",
           time:"2018.10.20 10:39 武汉"
        });
        //设置li的JS
        function AllSet(){
            let max=document.getElementsByClassName("list").length
            for(let i=0;i<max;i++){
                dis_divC(i);
                toggleC(i);
            }
        }
        //设置背景图片
        function SetBackGround(info){
            $.GetTag(info.el).SetBackG({
                MyUrl:"url("+info.url+")",
                MyStyle:info.MyStyle
            });
        }
        SetBackGround({
            el:"body",
           url:BgSz[3],
           MyStyle:"cover"
        });
        //定时切换背景图片
        function SwitchBg(speed){
            let i=1;
            let max=BgSz.length;
            let timer=setInterval(()=>{
                if(i>=max){
                    i=0;
                }else{
                    SetBackGround({
                        el:"body",
                        url:BgSz[i],
                        MyStyle:"cover"
                    });
                    i++;
                }
            },speed);
        }
        //设置所有li的JS代码
        AllSet();
        //切换图片
        // SwitchBg(5000);
    }
    </script>
</head>
<body>
<div class="banner">
    <span class="banner_text">It's not pain,it's just uncertainty，
        I konw my heart's missing a piece，but it still beats.</span>
</div>
<ul class="message_list">
</ul>
</body>
</html>
